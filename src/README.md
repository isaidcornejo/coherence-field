# Coherence Field — Experimental Suite

This directory contains the reproducible experiments used to validate the scalar alignment diagnostic:

[ A_q = \mathrm{Tr}(G^{-1}C) - D, \qquad \phi_q = \max{\sqrt{A_q}, 0}. ]

Each experiment computes:

* Fisher information matrix **G**
* Empirical score covariance **C**
* Alignment operator:
  [ H = G^{-1/2} C G^{-1/2} ]
* Eigenvalues **λᵢ**
* Scalar invariant **A_q**
* Rectified coherence amplitude **φ_q**

All results and figures are generated by:

```
python -m src.generate_figures
```

Figures are saved to: `paper/figures/`

Results (arrays, spectra, invariants) to: `results/`

---

## 1. Gaussian Family — `experiments/gaussian/`

Demonstrates Fisher equilibrium and controlled misalignment via mean-shift.

Files:

* `model.py` — Gaussian sampling & score functions
* `equilibrium.py`
* `misalignment.py`
* `run_gaussian.py`

Outputs:

* Equilibrium spectrum (λ≈1)
* Misalignment spectrum with reinforcement/suppression

---

## 2. Laplace Family — `experiments/laplace/`

Demonstrates the **suppression regime** where A_q < 0.

Files:

* `model.py` — Laplace sampling & scores
* `equilibrium.py`
* `misalignment.py`
* `run_laplace.py`

Outputs:

* Slight deviation even in equilibrium (non-exponential family)
* Global suppression when misaligned

---

## 3. Gaussian Mixture Model — `experiments/gmm/`

Shows strong reinforcement modes and outlier eigenvalues.

Files:

* `model.py`
* `equilibrium.py`
* `misalignment.py`
* `run_gmm.py`

Outputs:

* Dominant alignment directions (λ ≫ 1)
* Multimodality-induced anisotropy

---

## 4. MNIST MLP — `experiments/mnist/`

A real-world neural network experiment demonstrating empirical coherence.

Files:

* `model.py`
* `score.py`
* `alignment.py`

Outputs:

* Spectrum with large outlier curvature modes
* A_q and φ_q measuring training-induced alignment
* Training/test loss curves

---

## Reusable Components — `src/utils/`

* `alignment_core.py` — computation of the alignment operator H, scalar diagnostics A and φ
* `matrix_utils.py` — linear-algebra utilities (inversion, square roots, eigenvalues)
* `experiment_io.py` — saving results and figures
* `plot_utils.py` — plotting helpers for spectra and diagnostics
* `paths.py` — centralized filesystem paths and directory management

---

## Adding a New Experiment

1. Create new folder:

   ```
   src/experiments/<name>/
   ```
2. Add:

   * `model.py`
   * `score.py`
   * `equilibrium.py` or `misalignment.py`
   * `run_<name>.py`
3. Import the runner in `src/generate_figures.py`.
4. Run:

   ```
   python -m src.generate_figures
   ```

---

## Citation

If you use this suite, please cite:

> **A Scalar Diagnostic for Empirical Score Alignment on Fisher Manifolds**
> I. Cornejo, 2025.
